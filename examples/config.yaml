secretStore:
  address: "http://localhost:8200"
  authMethod: "token"
  token: "dev-root-token"

# Each secret defines:
# 1. key - Path to the secret in Vault
# 2. mountPath - KV secrets engine mount path
# 3. kvVersion - KV engine version (v1 or v2)
# 4. template.data - Map of keys to template expressions
# 5. files - List of output files
# The mapping is positional: data keys are written to files in order
#   - First key in template.data -> First file in files list
#   - Second key in template.data -> Second file in files list
#   - etc.

secrets:
  - name: "tls-cert"
    key: "common/tls/example-cert"
    mountPath: "secret"
    kvVersion: "v2"
    refreshInterval: "30m"
    template:
      data:
        tls.crt: '{{ .tlsCrt }}'    # -> .work/secrets/tls.crt
        tls.key: '{{ .tlsKey }}'    # -> .work/secrets/tls.key
    files:
      - path: ".work/secrets/tls.crt"
        mode: "0644"
      - path: ".work/secrets/tls.key"
        mode: "0600"

  - name: "database-creds"
    key: "database/prod/credentials"
    mountPath: "secret"
    kvVersion: "v2"
    refreshInterval: "5m"
    template:
      data:
        username: '{{ .username }}'  # -> .work/secrets/db-username
        password: '{{ .password }}'  # -> .work/secrets/db-password
    files:
      - path: ".work/secrets/db-username"
        mode: "0600"
      - path: ".work/secrets/db-password"
        mode: "0600"

  - name: "api-keys"
    key: "app/config"
    mountPath: "secret"
    kvVersion: "v2"
    refreshInterval: "1h"
    template:
      data:
        api_key: '{{ .apiKey }}'       # -> .work/secrets/api-key
        api_secret: '{{ .apiSecret }}' # -> .work/secrets/api-secret
    files:
      - path: ".work/secrets/api-key"
        mode: "0600"
      - path: ".work/secrets/api-secret"
        mode: "0600"
